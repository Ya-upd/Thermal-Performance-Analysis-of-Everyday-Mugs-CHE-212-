% raw data
data =  [28.4 29.2 28.4 29.3 28.4 29.3 28.4 29.3 28.4 29.3 28.4 29.3 28.4 29.3 28.4 29.3 28.4 29.4 28.5 29.6 28.5 29.8 28.6 30.1 33.2 30.4 40.6 30.7 48.3 31 55.7 31.3 62.4 31.7 68.2 31.9 72.9 32.2 77.1 32.5 80.4 32.9 83.3 33.2 85.5 33.5 87.3 33.8 88.5 33.9 89.7 34.3 90.6 34.5 91.4 34.8 91.9 35 92.3 35.3 93.2 35.5 93.2 35.6 93.2 35.8 93.2 36 93.7 36.2 93.7 36.4 93.7 36.6 93.7 36.8 94.2 36.9 93.7 37.1 93.7 37.2 93.7 37.3 93.7 37.5 93.7 37.6 93.7 37.7 93.7 37.8 94.2 37.9 94.2 38.1 93.7 38.3 94.2 38.5 93.7 38.6 93.7 38.6 93.2 38.9 93.7 38.9 93.7 39.1 93.7 39.2 93.7 39.3 93.7 39.5 93.7 39.6 93.2 39.7 93.7 39.9 93.7 40 93.2 40.3 93.2 40.4 93.2 40.5 93.2 40.6 93.2 40.7 93.2 40.7 93.2 40.7 93.2 40.7 93.2 40.8 93.2 40.9 93.2 41 93.2 41.1 93.2 41 93.2 41 93.7 41.1 93.2 41.2 92.8 41.1 92.8 41.4 92.8 41.5 93.2 41.6 92.8 41.6 92.8 41.6 93.2 41.6 92.3 41.6 92.8 41.7 93.2 41.7 92.8 41.7 92.8 41.8 92.8 41.8 92.8 41.7 93.2 41.7 93.2 41.7 92.8 41.8 92.3 41.9 92.8 41.9 92.8 41.9 92.3 42 93.2 42.1 92.8 42.1 92.8 42.1 92.8 42.1 92.8 42.1 93.2 42 92.8 42 92.3 42 92.8 42 92.3 42 92.8 42 92.8 42 92.3 41.9 92.3 41.9 92.3 41.8 92.8 42 91.9 42.1 92.3 42.1 91.9 42.1 92.3 42.1 92.3 42.2 92.3 42.3 92.3 42.3 92.3 42.5 91.9 42.6 92.3 42.8 92.3 42.9 92.8 42.9 92.3 42.9 92.3 42.8 92.3 42.8 92.3 42.8 92.8 42.8 92.3 42.8 92.3 42.7 92.3 42.7 91.9 42.6 91.9 42.3 92.3 42.5 92.3 42.5 91.9 42.5 91.9 42.3 91.9 42.3 91.9 42.3 91.9 42.3 91.9 42.3 91.9 42.3 91.9 42.5 92.3 42.5 91.9 42.5 91.9 42.5 92.3 42.6 91.9 42.7 91.9 42.8 91.9 42.8 91.9 42.8 91.9 42.8 91.9 42.8 91.9 42.8 91.9 42.7 91.9 42.5 91 42.3 91.9 42.3 91.9 42.3 91.4 42.2 91.9 42.2 91.4 42.3 91.4 42.5 91.9 42.6 91.4 42.7 91 42.7 91 42.7 91 42.7 91.4 42.7 91 42.7 91 42.7 91 42.5 91.4 42.6 91.4 42.7 91.4 42.7 91.4 42.7 91.4 42.8 91.4 42.8 91.4 42.9 91.4 43.1 91.4 43.1 91 43.3 91 43.4 91 43.4 91.4 43.4 91 43.4 91 43.4 91 43.5 91 43.5 91.4 43.4 91 43.4 91.4 43.5 91 43.4 91 43.4 91 43.4 91.4 43.5 90.6 43.5 91.4 43.3 90.6 43.3 91 43.1 90.6 43 91 43.1 90.1 43.1 91 43.1 91 43.1 91 43.1 91 43.1 91 43.1 91 43.1 91 43 90.6 43.1 90.6 43.1 90.6 43 90.6 43 90.6 43 90.6 42.9 91 42.9 90.6 42.9 90.6 42.8 90.6 42.8 90.6 42.8 90.6 42.8 90.6 42.8 90.6 42.8 90.6 42.7 90.6 42.7 90.1 42.6 90.6 42.6 90.6 42.6 90.1 42.5 90.6 42.5 90.6 42.5 90.6 42.7 90.6 42.8 90.6 42.7 90.1 42.7 90.6 42.8 90.1 42.9 90.6 42.9 90.1 42.8 90.1 42.8 90.1 42.8 90.1 42.8 90.6 42.9 90.1 42.8 90.1 42.8 90.1 42.7 90.1 42.7 89.3 42.6 90.6 42.6 90.1 42.5 90.1 42.5 90.1 42.3 90.1 42.2 90.1 42.2 90.1 42.2 90.6 42.2 90.1 42.2 90.6 42.2 89.7 42.1 90.1 41.9 90.1 41.9 90.1 41.8 89.7 41.8 90.1 41.8 90.1 41.9];
inner_temp = data(1:2:end);
outer_temp = data(2:2:end);
% for the mug stainless steel 304
rho = 8000;      % density
cp  = 900;       % specific heat
h   = 100;       % convective coefficient (W/m^2·K)
dt  = 1;         % time step (s)
% Dimensions of the cup
R_top = 0.071; R_bot = 0.054; H = 0.085; t = 0.004;
r_top = R_top - t; r_bot = R_bot - t;
% Frustum slant and inner surface area
s = sqrt((r_top - r_bot)^2 + H^2);
A = pi * (r_top + r_bot) * s;
% Shell volume and mass
V_outer = (pi*H/3)*(R_top^2 + R_top*R_bot + R_bot^2);
V_inner = (pi*H/3)*(r_top^2 + r_top*r_bot + r_bot^2);
V_shell = V_outer - V_inner;
m = rho * V_shell;
% Lumped modelling
Bi = h * t / 15;  % using k ≈ 15 W/m·K
fprintf('Mass = %.3f kg, Area = %.3f m^2, Biot = %.3f\n', m, A, Bi);
% Modelling for heating phase only
diffs = diff(outer_temp);
idx_peak = find(diffs < 0, 1, 'first') + 1;
if isempty(idx_peak)
    idx_peak = length(outer_temp);
end
% Using heting phase
n0 = idx_peak;
t_inner = inner_temp(1:n0);
t_outer = outer_temp(1:n0);

T_inf = mean(t_inner);
T_model = zeros(1, n0);
T_model(1) = t_outer(1);
for i = 2:n0
    dTdt = (h*A)/(m*cp) * (T_inf - T_model(i-1));
    T_model(i) = T_model(i-1) + dTdt * dt;
end
% Plot 
time = (0:n0-1)*dt;
figure;
plot(time, t_outer, 'b-', 'LineWidth', 2); hold on;
plot(time, T_model, 'r--', 'LineWidth', 2);
xlabel('Time (s)');
ylabel('Temperature (°C)');
xlim([0,60]);
ylim([0 100]);
legend('Measured Outer', 'Modeled (Initial Phase)');
title('Initial Heating Phase: Vacuum-Mug Wall');
grid on;